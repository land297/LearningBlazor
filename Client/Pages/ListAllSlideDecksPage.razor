@page "/listAllSlideDecksPage"
@inject Learning.Client.Services.ISlideDeckService SlideDeckService
@inject NavigationManager NavigationManager
@inject ISnackbar Snackbar
@using Learning.Shared.DbModels

<h3>ListAllSlideDecksPage</h3>

<AuthorizeView Roles="Admin,ContentCreator">
    <Authorized>
        @if (SlideDecksAll != null) {
            <MudTable Items="@SlideDecksAll" Hover="true" Breakpoint="Breakpoint.Sm">

                <HeaderContent>
                    <MudTh>Title</MudTh>
                    <MudTh>Description</MudTh>
                    <MudTh>Page count</MudTh>
                    <MudTh>AccessLevel</MudTh>
                </HeaderContent>
                <RowTemplate Context="deck">
                    <MudTd>@deck.Title</MudTd>
                    <MudTd>@deck.Description</MudTd>
                    <MudTd>@deck.Slides.Count</MudTd>
                    <MudTd>@deck.AccessLevel</MudTd>
                    <MudTd><MudButton OnClick="@(() => NavigationManager.NavigateTo($"viewSlideDeck/{deck.Id}"))">View</MudButton></MudTd>
                    <MudTd><MudButton OnClick="@(() => NavigationManager.NavigateTo($"editSlideDeck/{deck.Id}"))">Edit</MudButton></MudTd>

                </RowTemplate>
            </MudTable>
        }
    </Authorized>
</AuthorizeView>

@if (SlideDecksPublished != null) {

    @*<MudGrid>
        <MudItem xs="1" sm="3"></MudItem>*@
    <MudContainer MaxWidth="MaxWidth.Medium">
        @foreach (var slidedeck in SlideDecksAll) {
            @*<MudItem xs="10" sm="6">*@
                <MudPaper Elevation="3" Class="pa-2 mb-4">
                    <MudText Typo="Typo.h6">@slidedeck.Title</MudText>
                    @if (!string.IsNullOrWhiteSpace(slidedeck.CoverImage)) {
                        <div>
                            <img src="@slidedeck.CoverImage" class="width:100%;" />

                        </div>
                    }
                    <MudText Typo="Typo.body1">@slidedeck.Description</MudText>
                    <MudButton Variant="Variant.Text" Color="Color.Primary" OnClick="@(() => NavigationManager.NavigateTo($"viewSlideDeck/{slidedeck.Id}"))">Learn More</MudButton>
                </MudPaper>
            @*</MudItem>*@
        }
        @*<MudItem xs="1" sm="3"></MudItem>*@
        @*</MudGrid>*@
        </MudContainer>
        }

        @code {
            List<SlideDeck> SlideDecksPublished;
            List<SlideDeck> SlideDecksAll;
protected override async Task OnInitializedAsync() {
            var r = await SlideDeckService.GetPublished();
            if (r.Success) {
                SlideDecksPublished = r.Data;
            } else {
                Snackbar.Add($"Could not get publushed. Error: {r.Message}", Severity.Error);
            }

            r = await SlideDeckService.GetAsContentCreator();
            if (r.Success) {
                SlideDecksAll = r.Data;
            } else {
                Snackbar.Add($"Could not get as content creator. Error: {r.Message}", Severity.Error);
            }
        }
        }
